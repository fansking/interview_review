# 中断

【中断的概念】

中断是指程序执行过程中，遇到急需处理的事件时，暂时中止CPU上现行程序的运行，转去执行相应的事件处理程序，待处理完成后再返回原程序被中断处或调度其他程序执行的过程
操作系统是“中断驱动”的；换言之，中断（广义）是激活操作系统的唯一方式
中断有广义和狭义之分，上述中断时指广义的中断
【中断、异常与系统异常】

狭义的中断来源于处理器之外的中断事件，即与当前运行指令无关的中断事件，如I/O中断、时钟中断、外部信号中断等
异常（来源于CPU内部的中断事件，和狭义共同构成广义的中断）指当前运行指令引起的中断事件，如地址异常、算术异常、处理器硬件故障等
系统异常与硬件无关，系统异常指执行陷入指令而触发系统调用引起的中断事件，如请求设备、请求I/O、创建进程等
【中断源—处理器硬件故障中断事件】

由处理器、内存储器、总线等硬件故障引起
处理原则为：保护现场，停止设备，停止CPU，向操作员报告，等待人工干预
【中断源—程序性中断事件】

处理器执行机器指令引起
除数为零、操作数溢出等算术异常：简单处理，报告用户；也可以由用户编写中断续元程序处理
非法指令、用户态使用特权指令、地址越界、非法存取等指令异常：终止进程
终止进程指令：终止进程
虚拟地址异常：调整内存后重新执行指令
【中断源—自愿性中断事件】

处理器执行陷入指令请求OS服务引起；在操作系统中，它一般又被称作系统调用
请求分配外设、请求I/O、等等
处理流程是：陷入OS，保护现场，根据功能号查入口地址，跳转具体处理程序
【中断源—I/O中断事件】

来源于外围设备报告I/O状态的中断事件
I/O完成：调整进程状态，释放等待进程
I/O出错：等到人工干预
I/O异常：等待人工干预
【中断源—外部中断事件】

由外围设备发出的信号引起的中断事件
时钟中断、间隔时钟中断：记时与时间片处理
设备报到与结束中断：调整设备表
键盘/鼠标信号中断：根据信号做出相应反映
关机/重启动中断：写回文件，停止设备与CPU
【中断系统】

中断系统是计算机系统中响应和处理中断的系统，包括硬件子系统和软件子系统两部分
中断响应由硬件子系统完成
中断处理由软件子系统完成



**(1) 硬中断**

由与系统相连的外设(比如网卡、硬盘)自动产生的。主要是用来通知操作系统系统外设状态的变化。比如当网卡收到数据包

的时候，就会发出一个中断。我们通常所说的中断指的是硬中断(hardirq)。

 

**(2) 软中断**

为了满足实时系统的要求，中断处理应该是越快越好。linux为了实现这个特点，当中断发生的时候，硬中断处理那些短时间

就可以完成的工作，而将那些处理事件比较长的工作，放到中断之后来完成，也就是软中断(softirq)来完成。
